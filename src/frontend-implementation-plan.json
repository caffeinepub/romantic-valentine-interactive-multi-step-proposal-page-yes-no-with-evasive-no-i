{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Fix production load, remove external fonts, add in-app share UI, and prepare for redeploy",
  "requirements": [
    {
      "id": "REQ-11",
      "summary": "Ensure production deployment serves a real built bundle (not /src/* at runtime) and that all JS/CSS/assets load successfully from the icp0.io root domain.",
      "acceptanceCriteria": [
        "Opening the production URL in Chrome, Firefox, and mobile Chrome loads the Valentine flow and shows the first (proposal) step without a blank screen or console errors caused by missing /src/* resources.",
        "All required JS/CSS/assets are served successfully (no 404s for entry scripts/styles) when loading the production URL.",
        "Static assets referenced by the app (e.g., /assets/generated/*) load successfully in production (no broken images/backgrounds)."
      ],
      "file_operations": [
        {
          "path": "frontend/index.html",
          "operation": "modify",
          "description": "Update the HTML entry to be production-safe for deployment hosting: remove any dev-only assumptions and ensure the production build pipeline (from the build-template-react / initial-app templates) will emit a built HTML referencing bundled assets rather than requiring /src/* at runtime. Verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/vite.config.ts",
          "operation": "create",
          "description": "Add/standardize Vite production build configuration suitable for icp0.io root hosting (asset base/path handling, output directory defaults), aligned with build-template-react expectations so the deployed artifact is a production build. Verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/package.json",
          "operation": "create",
          "description": "Add/standardize frontend build scripts (dev/build/preview) so the deployment process produces and publishes the compiled production artifact rather than raw source. Align with build-template-react conventions. Verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/components/valentine/assets.ts",
          "operation": "modify",
          "description": "Verify and, if needed, adjust static asset paths so they resolve correctly in production (icp0.io root) and match the deployed asset locations under frontend/public/assets (e.g., /assets/generated/*). Verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/index.css",
          "operation": "modify",
          "description": "Verify CSS references to static assets (e.g., hearts pattern background) resolve in production and match the deployed asset locations; avoid runtime 404s. Verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/public/assets/generated/couple-hero.dim_1400x900.png",
          "operation": "create",
          "description": "Place the generated image asset at this exact path so production can load /assets/generated/couple-hero.dim_1400x900.png without 404s."
        },
        {
          "path": "frontend/public/assets/generated/hearts-pattern.dim_1024x1024.png",
          "operation": "create",
          "description": "Place the generated image asset at this exact path so production can load /assets/generated/hearts-pattern.dim_1024x1024.png without 404s."
        },
        {
          "path": "frontend/public/assets/audio/haseen.mp3",
          "operation": "create",
          "description": "Place audio assets under frontend/public/assets/audio so any existing audioPath references can load reliably in production (repeat for remaining tracks used by the app)."
        },
        {
          "path": "frontend/public/assets/audio/high-on-you.mp3",
          "operation": "create",
          "description": "Place audio asset for production bundling/serving under frontend/public/assets/audio."
        },
        {
          "path": "frontend/public/assets/audio/ishq-hai.mp3",
          "operation": "create",
          "description": "Place audio asset for production bundling/serving under frontend/public/assets/audio."
        },
        {
          "path": "frontend/public/assets/audio/ranjheya-ve.mp3",
          "operation": "create",
          "description": "Place audio asset for production bundling/serving under frontend/public/assets/audio."
        },
        {
          "path": "frontend/public/assets/audio/zulfein.mp3",
          "operation": "create",
          "description": "Place audio asset for production bundling/serving under frontend/public/assets/audio."
        }
      ]
    },
    {
      "id": "REQ-12",
      "summary": "Remove runtime dependency on Google Fonts so the app remains styled/readable when external font CDNs are blocked.",
      "acceptanceCriteria": [
        "The deployed app loads and remains readable/styled even when the browser blocks requests to https://fonts.googleapis.com and https://fonts.gstatic.com.",
        "No external font stylesheet links remain in the production HTML output."
      ],
      "file_operations": [
        {
          "path": "frontend/index.html",
          "operation": "modify",
          "description": "Remove external Google Fonts <link> tags (preconnect and stylesheet) so production HTML has no dependency on fonts.googleapis.com / fonts.gstatic.com."
        },
        {
          "path": "frontend/src/index.css",
          "operation": "modify",
          "description": "Update global typography to use a fully local/system font stack (or locally bundled fonts if added) to replace Inter/Playfair Display; ensure body and heading font-family declarations no longer require external CDNs."
        },
        {
          "path": "frontend/tailwind.config.js",
          "operation": "modify",
          "description": "Update Tailwind fontFamily configuration to match the new local/system font stack so existing Tailwind typography stays consistent without external font downloads."
        }
      ]
    },
    {
      "id": "REQ-13",
      "summary": "Prepare the frontend project for republishing and provide guidance to produce and verify a new working icp0.io share URL after fixes.",
      "acceptanceCriteria": [
        "A new production deployment is created.",
        "A new working share URL (icp0.io) is produced and verified to load the app."
      ],
      "file_operations": [
        {
          "path": "frontend/DEPLOYMENT.md",
          "operation": "create",
          "description": "Document the exact build-and-publish steps to ensure a production build artifact is deployed (not raw source), including a verification checklist for: (1) no /src/* requests in production, (2) no missing JS/CSS/assets, (3) generated new icp0.io share URL and confirm it loads the proposal step."
        },
        {
          "path": "frontend/package.json",
          "operation": "modify",
          "description": "Add/adjust scripts needed by the chosen deployment flow (aligned with github-export-icp-cli expectations where applicable) so republishing runs a production build before upload. Verify the component's usage instructions before implementing."
        }
      ]
    },
    {
      "id": "REQ-14",
      "summary": "Add an in-app Share UI that shows the current URL and supports one-tap copy with a clear success state.",
      "acceptanceCriteria": [
        "The app displays the current URL (derived from window.location) in a share UI.",
        "Tapping “Copy link” copies the URL to the clipboard and provides a clear success state (English text).",
        "The share UI does not require any external network services (e.g., no third-party QR endpoints)."
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/valentine/ShareSection.tsx",
          "operation": "create",
          "description": "Create a Share section component that reads window.location.href, displays it, and provides a “Copy link” action using the Clipboard API (with a safe fallback) plus an English success state. Use existing shadcn-ui components where appropriate (compose only; do not modify frontend/src/components/ui). Verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/components/valentine/hooks/useCopyToClipboard.ts",
          "operation": "create",
          "description": "Add a small hook to encapsulate clipboard copying, fallback behavior, and transient success/error state for the Share UI."
        },
        {
          "path": "frontend/src/components/valentine/ValentineFlow.tsx",
          "operation": "modify",
          "description": "Wire the new ShareSection into the existing Valentine flow layout (no new routes/pages) so it is accessible while users view the flow, without disrupting the first proposal step."
        }
      ]
    }
  ]
}